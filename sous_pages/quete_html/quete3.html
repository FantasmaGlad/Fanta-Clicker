<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quête 3 - Baa-Clicker</title>
    <link rel="stylesheet" href="../../assets/styles/global.css">
</head>

<body>
    <div class="container">
        <h1>Quête 3</h1>
        <p>Objectif : Produire 1000 Baamix</p>
        <div class="progress-container">
            <div class="progress-bar" id="progress-bar"></div>
        </div>
        <p id="status">Progression : 0/1000 Baamix</p>

        <button id="claim-button" class="disabled-button" disabled>Réclamer la récompense</button>
        <button class="back-button" id="return-to-game">Retour au jeu</button>
    </div>

    <script src="../../scripts/utile.js"></script>
    <script>
        let objectifProduction = 1000;
        let baamixProduits = 0;

        function verifierProgression() {
            const scoreActuel = parseInt(localStorage.getItem("baamix_score") || 0); // Nombre total de Baamix produits
            if (scoreActuel >= objectifProduction) {
                document.getElementById("status").innerText = `Progression : ${objectifProduction}/${objectifProduction} Baamix`;
                document.getElementById("progress-bar").style.width = "100%";
                const boutonReclamer = document.getElementById("claim-button");
                boutonReclamer.disabled = false;
                boutonReclamer.classList.remove("disabled-button");
                boutonReclamer.classList.add("active-button");
            } else {
                const pourcentage = Math.min((scoreActuel / objectifProduction) * 100, 100);
                document.getElementById("progress-bar").style.width = `${pourcentage}%`;
                document.getElementById("status").innerText = `Progression : ${scoreActuel}/${objectifProduction} Baamix`;
            }
        }

        window.onload = () => {
            const returnButton = document.getElementById("return-to-game");
            returnButton.addEventListener("click", () => {
                window.location.href = "../../pageprincipale.html";
            });

            const boutonReclamer = document.getElementById("claim-button");
            boutonReclamer.addEventListener("click", () => {
                if (!boutonReclamer.disabled) {
                    jouerSonReussite("../../assets/sons/amelio.mp3");
                    alert("Quête 3 accomplie ! Félicitations !");
                }
            });

            setInterval(verifierProgression, 500); // Vérifie la progression toutes les 500ms
        };
    </script>
</body>

</html>